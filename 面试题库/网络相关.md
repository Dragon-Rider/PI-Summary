- [1. 三种方法实现js跨域访问](#1-三种方法实现js跨域访问)
  - [1.1：跨域普通请求（get，post）在服务端是否都会执行？](#11跨域普通请求getpost在服务端是否都会执行)
  - [1.2：预检请求（options）是什么？什么情况下会发送？](#12预检请求options是什么什么情况下会发送)
- [2. 从输入 URL 到页面加载完的过程中都发生了什么事情？](#2-从输入-url-到页面加载完的过程中都发生了什么事情)
- [3. XSS 和 CSRF 是什么，如何预防？](#3-xss-和-csrf-是什么如何预防)
- [4. 分片上传怎么实现？断点上传怎么实现？我现在上传图片的时候提前预览到图片怎么办？](#4-分片上传怎么实现断点上传怎么实现我现在上传图片的时候提前预览到图片怎么办)
- [5. http 和 https 的区别及优缺点](#5-http-和-https-的区别及优缺点)
- [6. https 协议的工作原理](#6-https-协议的工作原理)
- [7. TCP三次握手的过程](#7-tcp三次握手的过程)
- [8. TCP四次挥手的过程](#8-tcp四次挥手的过程)
- [9. TCP 和 UDP 的区别](#9-tcp-和-udp-的区别)
- [10. 解释下TCP/IP 四层模型，和 http, tcp, ip 的关系](#10-解释下tcpip-四层模型和-http-tcp-ip-的关系)
- [11. 解释下 TCP 长链接和 HTTP 短链接的区别和应用？](#11-解释下-tcp-长链接和-http-短链接的区别和应用)
- [12. 解释下 WebSocket 的作用？说下 WebSocket 是如何建立的？ 有什么特点](#12-解释下-websocket-的作用说下-websocket-是如何建立的-有什么特点)
- [13. 浏览器的缓存机制 强制缓存 \&\& 协商缓存](#13-浏览器的缓存机制-强制缓存--协商缓存)
- [14. SEO 的方式](#14-seo-的方式)
- [15. SSR 的好处](#15-ssr-的好处)

## 1. 三种方法实现js跨域访问
跨域实现
- 基于iframe实现跨域，设置 document.domain
- 基于script标签实现跨域 ，`JSONP` 就是这么实现的，JSONP 缺点是只能 get 请求
- `Nginx反向代理`
- 使用`CORS`(跨域资源共享)方式实现跨域
  - 服务端 `access-control-allow-origin` 设置制定域名或者 *，以实现跨域配置。
  - 前端请求 header 设置 withCredentials 为 true（这个是为了“跨域请求“头能带上 cookie ，并`不是跨域必须的`）
- 使用 WebSocket，也无同源限制
[link1](https://www.cnblogs.com/nizuimeiabc1/p/13060306.html), [link2](https://mp.weixin.qq.com/s/cn3n-ItaW4L-p9HKrv8TKQ)

### 1.1：跨域普通请求（get，post）在服务端是否都会执行？
跨域请求在服务端一定会执行。原因：

- “同源策略”MDN上写清楚了是，浏览器策略

- 任何 http request header 都可以被篡改，服务端心有余而力不足

- 因为你只有发出去了，才能收到服务端的 Response，浏览器根据 “access-control-allow-origin” 知道能否允许跨域。
  所以，请求一定是先发出去，在返回来的时候被浏览器拦截了，如果请求是有返回值的，会被浏览器隐藏掉。

### 1.2：预检请求（options）是什么？什么情况下会发送？
预检请求有一个很重要的作用就是 询问 服务端是不是允许这次请求，如果当前请求是个跨域的请求，你可以理解为：询问 服务端是不是允许请求在当前域下跨域发送。当然，它还有其他的作用，比如 询问 服务端支持哪些 HTTP 方法。

请求分为：“简单请求” 和 “复杂请求”。 “简单请求” ，需要同时满足 [4个条件](https://mp.weixin.qq.com/s/cn3n-ItaW4L-p9HKrv8TKQ)，不会发预检请求（preflight），“复杂请求“会发。

## 2. 从输入 URL 到页面加载完的过程中都发生了什么事情？
1. 把URL分割成几个部分：协议、网络地址、资源路径。
2. DNS域名解析：如果地址不是一个IP地址，通过`DNS`（域名系统）将该地址解析成IP地址。
3. 确定端口号。
4. 建立 `TCP` 连接：向2和3确定的IP和端口号发起网络连接
5. 发起 `HTTP` 请求：根据http协议要求，组织一个请求的数据包，里面包含大量请求信息，包括请求的资源路径、你的身份。
6. 服务器响应请求，将数据返回给浏览器。（可能会有 Nginx 反向代理，解决跨域或者负载均衡等问题）
7. 如果（6）返回的是一个页面，根据页面里一些外链的URL，例如图片的地址，按照（1）－（6）再次获取。（可能会有 CDN 加速资源的获取）
8. 开始根据资源的类型，将资源组织成屏幕上显示的图像，这个过程叫渲染，网页渲染是浏览器最复杂、最核心的功能。
9. 将渲染好的页面图像显示出来，并开始响应用户的操作。

## 3. XSS 和 CSRF 是什么，如何预防？

## 4. 分片上传怎么实现？断点上传怎么实现？我现在上传图片的时候提前预览到图片怎么办？
[link1](https://juejin.cn/post/6844904090275676167), [link2](https://juejin.cn/post/6844904046436843527)

## 5. http 和 https 的区别及优缺点
- http 是超文本传输协议，信息是`明文传输`，HTTPS 协议要比 http 协议安全，https 是具有安全性的 ssl 加密传输协议，可防止数据在传输过程中被窃取、改变，确保数据的完整性
- http port:80; https port：443
- https 要买 CA 证书
[link](https://juejin.cn/post/7016593221815910408)

## 6. https 协议的工作原理
非对称加密。服务器有私钥；将公钥给客户端，客户端加密数据；
[link](https://juejin.cn/post/7016593221815910408)

## 7. TCP三次握手的过程
1. 第一次握手：客户端 -> 服务器；发送 SYN 包（Synchronize Sequence Numbers：同步序列编号）

2. 第二次握手：服务器 -> 客户端；发送 SYN  + ACK 包（确认宝）

3. 第三次握手：客户端 -> 服务器；发送 ACK 包。双向建联完毕；

备注：握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。

[link](https://juejin.cn/post/7016593221815910408)

## 8. TCP四次挥手的过程
1. 第一次挥手：客户端 -> 服务器；发送 FIN 包

2. 第二次挥手：服务器 -> 客户端；发送 ACK 包，确认

3. 第三次挥手：服务器 -> 客户端，服务器发送完最后的数据后，发送 FIN=1，ACK.

4. 第四次挥手：客户端 -> 服务器，发送 ACK.

为啥断链接要四次，因为数据传输是异步的，服务器收到 FIN 消息后，可能还有数据没发完。

[link](https://juejin.cn/post/7016593221815910408)

## 9. TCP 和 UDP 的区别
- TCP是面向链接的，而UDP是面向无连接的。

- TCP仅支持单播传输，UDP 提供了单播，多播，广播的功能。

- TCP 是可靠的，UDP 不可靠

## 10. 解释下TCP/IP 四层模型，和 http, tcp, ip 的关系
- 应用层（HTTP、FTP、WebSocket）
- 传输层（TCP、UDP）
- 网络层（IP）
- 数据链路层

## 11. 解释下 TCP 长链接和 HTTP 短链接的区别和应用？
长链接和短链接的区别：

如果是长链接，服务端会在一定时间用户无操作后。定时发送数据包检测客户端的状态（心态）。短链接是用户发送本次的数据后，断开TCP链接。

应用场景1.0：

`长连接`多用于操作频繁（读写），`点对点的通讯`，而且连接数不能太多情况。每个TCP连接都需要三步握手，这需要时间，如果每个操作都是先连接，再操作的话那么处理速度会降低很多，所以每个操作完后都不断开，次处理时直接发送数据包就OK了，不用建立TCP连接。例如：数据库的连接用长连接， 如果用短连接频繁的通信会造成socket错误，而且频繁的socket 创建也是对资源的浪费。

而像WEB网站的`http服务`一般都用`短链接`（http 1.0只支持短连接，http 1.1 keep alive 带时间，操作次数限制的长连接），因为`长连接`对于服务端来说会`耗费`一定的资源，而像WEB网站这么频繁的成千上万甚至上亿客户端的连接用短连接会更省一些资源，如果用长连接，而且同时有成千上万的用户，如果每个用户都占用一个连接的话，那可想而知吧。所以并发量大，但每个用户无需频繁操作情况下需用短连好；

## 12. 解释下 WebSocket 的作用？说下 WebSocket 是如何建立的？ 有什么特点
WebSocket 是用来实现`双向通信`的技术，基于 `TCP 协议` 进行长链接。

1. 建立在 TCP 协议之上，服务器端的实现比较容易。

2. 与 HTTP 协议有着良好的兼容性。默认端口也是 80 和4 43，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。

3. 数据格式比较轻量，性能开销小，通信高效。

4. 没有同源限制，客户端可以与任意服务器通信。

5. 可以发送文本，也可以发送二进制数据。

6. 协议标识符是ws（如果加密，则为wss），服务器网址就是 URL。

## 13. 浏览器的缓存机制 强制缓存 && 协商缓存
- **强制缓存**：强制缓存就是`向浏览器`缓存查找该请求结果，并根据该结果的缓存规则来决定是否使用该缓存结果的过程。（`max-age、Cache-Control、Expires`）

- **协商缓存**：协商缓存就是强制缓存失效后，浏览器携带缓存标识`向服务器`发起请求，由服务器根据缓存标识决定是否使用缓存的过程（`Last-Modified / If-Modified-Since 和 Etag / If-None-Match`）

备注：`Etag` 是服务器响应请求时，返回当前资源文件的一个唯一标识(由服务器生成)，`类似 Hash`。

[link1](https://juejin.cn/post/7016593221815910408#heading-17)、[link2](https://juejin.cn/post/6992843117963509791#heading-9)

`实际应用策略`

网站的缓存设置的最佳实践是`入口 html` 文件 Cache-Control 设置 no-cache（`协商缓存`），`其他文件 max-age（强制缓存）`，这样入口文件会用本地缓存但每次都协商，能及时更新，而其他资源不会发请求，能减少服务端压力。

如果要更新的话，html 文件协商后发现有更新会下载新 html，这时候关联了其他 hash 的文件，浏览器会下载新的，不会走到之前文件的缓存。
[link3](https://juejin.cn/post/7163506251304239135)

## 14. SEO 的方式
- 头部标签 keyword, description 写好，让服务器抓取。中间的 img alt 那些也写好。

- 标签语义化，不要CSS也能渲染出页面的骨架

- SSR 服务端渲染

- SPA 的话有骚操作，“Nginx 代理”/ “路由中间件” 转发到静态页面，静态页不需要样式内容啥的，可以用 Nuxt 快速生成。或者“无头浏览器”做蜘蛛抓取然后模拟

## 15. SSR 的好处
- 可以做 SEO 提升网站排名。

- 更快的内容到达时间（time-to-content），特别是对于繁忙的网络情况或运行缓慢的设备。

